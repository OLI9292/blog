<meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Strange Keywords in Swift</title><meta content="width=device-width initial-scale=1" name="viewport" /><link href="https://oli9292.github.io/blog/strange-keywords-in-swift/" rel="canonical" /><meta content="https://oli9292.github.io/blog/strange-keywords-in-swift/" itemprop="url" /><script type='text/javascript'>/*!
loadCSS: load a CSS file asynchronously.
[c]2015 @scottjehl, Filament Group, Inc.
Licensed MIT
*/

(function(w){
  "use strict";
  /* exported loadCSS */
  w.loadCSS = function( href, before, media ){
    // Arguments explained:
    // `href` [REQUIRED] is the URL for your CSS file.
    // `before` [OPTIONAL] is the element the script should use as a reference for injecting our stylesheet <link> before
      // By default, loadCSS attempts to inject the link after the last stylesheet or script in the DOM. However, you might desire a more specific location in your document.
    // `media` [OPTIONAL] is the media type or query of the stylesheet. By default it will be 'all'
    var ss = w.document.createElement( "link" );
    var ref;
    if( before ){
      ref = before;
    }
    else if( w.document.querySelectorAll ){
      var refs = w.document.querySelectorAll(  "style,link[rel=stylesheet],script" );
      // No need to check length. This script has a parent element, at least
      ref = refs[ refs.length - 1];
    }
    else {
      ref = w.document.getElementsByTagName( "script" )[ 0 ];
    }

    var sheets = w.document.styleSheets;
    ss.rel = "stylesheet";
    ss.href = href;
    // temporarily set media to something inapplicable to ensure it'll fetch without blocking render
    ss.media = "only x";

    // Inject link
      // Note: the ternary preserves the existing behavior of "before" argument, but we could choose to change the argument to "after" in a later release and standardize on ref.nextSibling for all refs
      // Note: `insertBefore` is used instead of `appendChild`, for safety re: http://www.paulirish.com/2011/surefire-dom-element-insertion/
    ref.parentNode.insertBefore( ss, ( before ? ref : ref.nextSibling ) );
    // A method (exposed on return object for external use) that mimics onload by polling until document.styleSheets until it includes the new sheet.
    ss.onloadcssdefined = function( cb ){
      var defined;
      for( var i = 0; i < sheets.length; i++ ){
        if( sheets[ i ].href && sheets[ i ].href === ss.href ){
          defined = true;
        }
      }
      if( defined ){
        cb();
      } else {
        setTimeout(function() {
          ss.onloadcssdefined( cb );
        });
      }
    };

    // once loaded, set link's media back to `all` so that the stylesheet applies once it loads
    ss.onloadcssdefined(function() {
      ss.media = media || "all";
    });
    return ss;
  };
}(this));
</script><link href="https://fonts.googleapis.com/css?family=Vollkorn:400,400i,700,700i" rel="stylesheet" /><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,200i,300,300i,400,400i,600,700" rel="stylesheet" /><script>loadCSS('//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css');
loadCSS('/css/all.css');
function js_Load() {
  document.body.style.visibility='visible';
};</script><body onload="js_Load()" style="visibility: hidden"><div class="article-container"><div class="article"><a href="/blog"><div class="back-button"></div></a><p><span><div class="date">March 22, 2017</div></span><h1>Strange Keywords in Swift</h1><p><br></p>

<p><strong>AssociatedType</strong></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An associated type is a layer of abstraction for types or functions defined in Swift protocols.  The type of an associated type is not defined in the protocol so in this way it is similar to a generic.  When creating a class or struct that conforms to a protocol with an associated type, an actual type must be given.  This can be done implicitly, as shown in the function below, where the Adult class does not define <code>EmployeeKind</code>, but references it and gives it a type of <code>Bartender</code> in the <code>buyDrink</code> method.
<br><br></p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Foundation</span>

<span class="kd">protocol</span> <span class="kt">Liquid</span> <span class="p">{</span> <span class="p">}</span>

<span class="kd">class</span> <span class="kt">Beer</span> <span class="p">:</span> <span class="kt">Liquid</span> <span class="p">{</span> <span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">Customer</span> <span class="p">{</span>
    <span class="kd">associatedtype</span> <span class="kt">SafeLiquid</span>
    <span class="kd">associatedtype</span> <span class="kt">EmployeeKind</span>

    <span class="kd">func</span> <span class="nf">drink</span><span class="p">(</span><span class="nv">d</span><span class="p">:</span> <span class="kt">SafeLiquid</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">buyDrink</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="kt">EmployeeKind</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">Bar</span> <span class="p">{</span>
    <span class="kd">associatedtype</span> <span class="kt">DrinkType</span>
    <span class="kd">func</span> <span class="nf">sellDrink</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">DrinkType</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">Bartender</span> <span class="p">:</span> <span class="kt">Bar</span> <span class="p">{</span>
    <span class="kd">typealias</span> <span class="kt">DrinkType</span> <span class="o">=</span> <span class="kt">Beer</span>

    <span class="kd">func</span> <span class="nf">sellDrink</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">DrinkType</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">Beer</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">Adult</span><span class="p">:</span> <span class="kt">Customer</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">drink</span><span class="p">(</span><span class="nv">d</span><span class="p">:</span> <span class="kt">Beer</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">buyDrink</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="kt">Bartender</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">from</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="n">buyDrinkAndDrinkIt</span><span class="o">&lt;</span><span class="kt">T</span><span class="p">:</span> <span class="kt">Customer</span><span class="p">,</span> <span class="kt">U</span><span class="p">:</span> <span class="kt">Bar</span><span class="o">&gt;</span> <span class="p">(</span><span class="nv">customer</span><span class="p">:</span> <span class="kt">T</span><span class="p">,</span> <span class="nv">bartender</span><span class="p">:</span> <span class="kt">U</span><span class="p">)</span> <span class="k">where</span> <span class="kt">T</span><span class="o">.</span><span class="kt">SafeLiquid</span> <span class="o">==</span> <span class="kt">U</span><span class="o">.</span><span class="kt">DrinkType</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">drink</span> <span class="o">=</span> <span class="n">bartender</span><span class="o">.</span><span class="nf">sellDrink</span><span class="p">()</span>
    <span class="n">customer</span><span class="o">.</span><span class="nf">drink</span><span class="p">(</span><span class="nv">d</span><span class="p">:</span> <span class="n">drink</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">buyDrinkAndDrinkIt</span><span class="p">(</span><span class="nv">customer</span><span class="p">:</span> <span class="kt">Adult</span><span class="p">(),</span> <span class="nv">bartender</span><span class="p">:</span> <span class="kt">Bartender</span><span class="p">())</span>
</code></pre>
<p><br></p>

<p><strong><center>* * * * *</center></strong></p>

<p><strong>Dynamic</strong></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The <code>dynamic</code> keyword refers to the time to dispatch and can be applied to class functions or variables.  Dynamic dispatch occurs at runtime, as opposed to static dispatch, which runs at compile time.</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In Swift, static dispatch is concretely achieved through the use of <code>final</code> and <code>static</code>.  Static provides a performance boost because the compiler immediately knows what is being called at runtime.  Although, because Swift allows method and property overrides, it sometimes has to determine what you are referring to at runtime.
<br><br></p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">Insect</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">makeNoise</span><span class="p">(</span><span class="nv">noise</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">Bee</span><span class="p">:</span> <span class="kt">Insect</span> <span class="p">{</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">makeNoise</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Buzzz"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><br></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In the code above, if you were to call <code>makeNoise</code> on an instance of Animal, it is possible the Swift compiler would need to wait until runtime to determine, which class function you were referring to.</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When you use the dynamic keyword in Swift, it implicitly adds the @objc attribute and tells the compiler to use Objective-C runtime.</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Static dispatch is preferable, and almost always performed, however there are cases when explicitly adding dynamic can save your app from crashing.  These situations usually occur when functions or properties will be interfered with or transformed at runtime.  A common example is app analytics libraries.  If you don’t do so, the Swift compiler could perform optimizations on those functions that cause unintended effects or break your app.  Dynamic dispatch also allows for better interoperability with other things that run in Objective-C runtime, like Core Data and Key-Value Observing.</p>

<p><strong><center>* * * * *</center></strong></p>

<p><strong>Indirect</strong></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The <code>indirect</code> keyword allows for recursive enumerations.  You can place <code>indirect</code> before the enum&rsquo;s case(s) or before the enum itself.  Doing the latter enables indirection for all the enum&rsquo;s cases that could need it.  </p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The compiler does the job of inserting the necessary layer of indirection for the enum.
<br><br></p>
<pre class="highlight swift"><code><span class="kd">enum</span> <span class="kt">Nat</span> <span class="p">{</span>
    <span class="k">case</span> <span class="kt">Zero</span>
    <span class="kd">indirect</span> <span class="k">case</span> <span class="kt">Succ</span><span class="p">(</span><span class="kt">Nat</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<p><br></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Swift won&rsquo;t compile the above code without <code>indirect</code>.
<br><br></p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">zero</span><span class="p">:</span> <span class="kt">Nat</span> <span class="o">=</span> <span class="o">.</span><span class="kt">Zero</span>
<span class="k">let</span> <span class="nv">one</span><span class="p">:</span> <span class="kt">Nat</span> <span class="o">=</span> <span class="o">.</span><span class="kt">Succ</span><span class="p">(</span><span class="n">zero</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">two</span><span class="p">:</span> <span class="kt">Nat</span> <span class="o">=</span> <span class="o">.</span><span class="kt">Succ</span><span class="p">(</span><span class="o">.</span><span class="kt">Succ</span><span class="p">(</span><span class="o">.</span><span class="kt">Zero</span><span class="p">))</span>
<span class="k">let</span> <span class="nv">three</span><span class="p">:</span> <span class="kt">Nat</span> <span class="o">=</span> <span class="o">.</span><span class="kt">Succ</span><span class="p">(</span><span class="n">two</span><span class="p">)</span>
</code></pre>
<p><br></p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Being recursive, we can define a variable from our <code>Nat</code> enum using a previously defined <code>Nat</code>.</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The above code was taken from the beginning of a great blog post by Brandon Williams, in which he models natural numbers using an enumeration, and overloads operators so that cases from <code>Nat</code> can be added, multiplied, and more.</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check out his post <a href="http://www.fewbutripe.com/swift/math/2015/01/20/natural-numbers.html">here</a>.</p>
</p></div></div></body><footer><p>Oliver Plunkett</p><a href="mailto:otplunkett@gmail.com">Reachable by email</a></footer>